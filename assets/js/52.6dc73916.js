(window.webpackJsonp=window.webpackJsonp||[]).push([[52],{253:function(t,s,a){"use strict";a.r(s);var n={props:["slot-key"],mounted:function(){this.$nextTick(function(){this.$vuepress.$emit("AsyncMarkdownContentMounted",this.slotKey)})}},e=a(6),r=Object(e.a)(n,function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.slotKey}},[a("h1",{attrs:{id:"json-daten-von-webservice-abfragen-und-in-systemvariable-schreiben"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#json-daten-von-webservice-abfragen-und-in-systemvariable-schreiben","aria-hidden":"true"}},[t._v("#")]),t._v(" JSON Daten von Webservice abfragen und in Systemvariable schreiben")]),t._v(" "),a("p",[t._v("F端r dieses Beispiel wird ein Webservice verwendet der den aktuellen Wechselkurs des Bitcoin zur端ckgibt. Er eignet sich gut als Beispiel da er keinen API Key verlangt und das zur端ckgegebene JSON recht 端bersichtlich ist:")]),t._v(" "),a("p",[t._v("URL des Webservice: "),a("code",[t._v("https://api.coindesk.com/v1/bpi/currentprice.json")])]),t._v(" "),a("p",[t._v("Beispiel Daten:")]),t._v(" "),a("div",{staticClass:"language-Javascript line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t"),a("span",{attrs:{class:"token string"}},[t._v('"time"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t"),a("span",{attrs:{class:"token string"}},[t._v('"updated"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v('"Aug 3, 2018 20:09:00 UTC"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t\t"),a("span",{attrs:{class:"token string"}},[t._v('"updatedISO"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v('"2018-08-03T20:09:00+00:00"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t\t"),a("span",{attrs:{class:"token string"}},[t._v('"updateduk"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v('"Aug 3, 2018 at 21:09 BST"')]),t._v("\n\t"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t"),a("span",{attrs:{class:"token string"}},[t._v('"disclaimer"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v('"This data was produced from the CoinDesk Bitcoin Price Index (USD). Non-USD currency data converted using hourly conversion rate from openexchangerates.org"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t"),a("span",{attrs:{class:"token string"}},[t._v('"chartName"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v('"Bitcoin"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t"),a("span",{attrs:{class:"token string"}},[t._v('"bpi"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t"),a("span",{attrs:{class:"token string"}},[t._v('"USD"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\t"),a("span",{attrs:{class:"token string"}},[t._v('"code"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v('"USD"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t\t\t"),a("span",{attrs:{class:"token string"}},[t._v('"symbol"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v('"&#36;"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t\t\t"),a("span",{attrs:{class:"token string"}},[t._v('"rate"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v('"7,388.6163"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t\t\t"),a("span",{attrs:{class:"token string"}},[t._v('"description"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v('"United States Dollar"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t\t\t"),a("span",{attrs:{class:"token string"}},[t._v('"rate_float"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("7388.6163")]),t._v("\n\t\t"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t\t"),a("span",{attrs:{class:"token string"}},[t._v('"GBP"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\t"),a("span",{attrs:{class:"token string"}},[t._v('"code"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v('"GBP"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t\t\t"),a("span",{attrs:{class:"token string"}},[t._v('"symbol"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v('"&pound;"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t\t\t"),a("span",{attrs:{class:"token string"}},[t._v('"rate"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v('"5,683.2867"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t\t\t"),a("span",{attrs:{class:"token string"}},[t._v('"description"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v('"British Pound Sterling"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t\t\t"),a("span",{attrs:{class:"token string"}},[t._v('"rate_float"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("5683.2867")]),t._v("\n\t\t"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t\t"),a("span",{attrs:{class:"token string"}},[t._v('"EUR"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\t"),a("span",{attrs:{class:"token string"}},[t._v('"code"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v('"EUR"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t\t\t"),a("span",{attrs:{class:"token string"}},[t._v('"symbol"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v('"&euro;"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t\t\t"),a("span",{attrs:{class:"token string"}},[t._v('"rate"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v('"6,384.5550"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t\t\t"),a("span",{attrs:{class:"token string"}},[t._v('"description"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v('"Euro"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t\t\t"),a("span",{attrs:{class:"token string"}},[t._v('"rate_float"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("6384.555")]),t._v("\n\t\t"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\t"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br"),a("span",{staticClass:"line-number"},[t._v("20")]),a("br"),a("span",{staticClass:"line-number"},[t._v("21")]),a("br"),a("span",{staticClass:"line-number"},[t._v("22")]),a("br"),a("span",{staticClass:"line-number"},[t._v("23")]),a("br"),a("span",{staticClass:"line-number"},[t._v("24")]),a("br"),a("span",{staticClass:"line-number"},[t._v("25")]),a("br"),a("span",{staticClass:"line-number"},[t._v("26")]),a("br"),a("span",{staticClass:"line-number"},[t._v("27")]),a("br"),a("span",{staticClass:"line-number"},[t._v("28")]),a("br"),a("span",{staticClass:"line-number"},[t._v("29")]),a("br"),a("span",{staticClass:"line-number"},[t._v("30")]),a("br"),a("span",{staticClass:"line-number"},[t._v("31")]),a("br"),a("span",{staticClass:"line-number"},[t._v("32")]),a("br")])]),a("p",[a("img",{attrs:{src:"images/btc1.png",alt:""}})]),t._v(" "),a("h2",{attrs:{id:"inject-node"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#inject-node","aria-hidden":"true"}},[t._v("#")]),t._v(" Inject Node")]),t._v(" "),a("p",[t._v("Ein Inject Node wird genutzt um alle 60 Minuten eine Message zu erzeugen die den Flow startet:")]),t._v(" "),a("p",[a("img",{attrs:{src:"images/btc2.png",alt:""}})]),t._v(" "),a("h2",{attrs:{id:"http-request-node"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#http-request-node","aria-hidden":"true"}},[t._v("#")]),t._v(" HTTP Request Node")]),t._v(" "),a("p",[t._v("Der HTTP Request Node holt die Daten vom Webservice ab:")]),t._v(" "),a("p",[a("img",{attrs:{src:"images/btc3.png",alt:""}})]),t._v(" "),a("h2",{attrs:{id:"json-node"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#json-node","aria-hidden":"true"}},[t._v("#")]),t._v(" JSON Node")]),t._v(" "),a("p",[t._v("Der JSON Node parsed die vom HTTP Request Node erhaltene Daten:")]),t._v(" "),a("p",[a("img",{attrs:{src:"images/btc4.png",alt:""}})]),t._v(" "),a("h2",{attrs:{id:"change-node"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#change-node","aria-hidden":"true"}},[t._v("#")]),t._v(" Change Node")]),t._v(" "),a("p",[t._v("Der Change Node extrahiert die gew端nschte Property ("),a("code",[t._v("rate_float")]),t._v(") in der der Euro Kurs als Number enthalten ist:")]),t._v(" "),a("p",[a("img",{attrs:{src:"images/btc5.png",alt:""}})]),t._v(" "),a("p",[t._v("Hierf端r wird der "),a("a",{attrs:{href:"http://jsonata.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("JSONata"),a("OutboundLink")],1),t._v(" Ausdruck "),a("code",[t._v("msg.payload.bpi.EUR.rate_float")]),t._v(" genutzt. Das JSON Objekt befindet sich (Node-RED 端blich) in msg.payload, 端ber die Punkt-Notation wird dann auf das gew端nschte Unter-Objekt zugegriffen.")]),t._v(" "),a("h2",{attrs:{id:"ccu-sysvar-node"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ccu-sysvar-node","aria-hidden":"true"}},[t._v("#")]),t._v(" CCU Sysvar Node")]),t._v(" "),a("p",[t._v("Am Ende wird der Wert in eine Systemvariable geschrieben.")]),t._v(" "),a("p",[a("img",{attrs:{src:"images/btc6.png",alt:""}})]),t._v(" "),a("p",[a("img",{attrs:{src:"images/btc7.png",alt:""}})]),t._v(" "),a("h1",{attrs:{id:"flow-json"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#flow-json","aria-hidden":"true"}},[t._v("#")]),t._v(" Flow JSON")]),t._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('[{"id":"65b68306.0b66ec","type":"http request","z":"4c052757.6ab828","name":"http get api.coindesk.com","method":"GET","ret":"txt","url":"https://api.coindesk.com/v1/bpi/currentprice.json","tls":"","x":390,"y":220,"wires":[["cd1a4c0c.0147c"]]},{"id":"c30aecd5.90709","type":"inject","z":"4c052757.6ab828","name":"","topic":"alle 60 minuten","payload":"","payloadType":"str","repeat":"3600","crontab":"","once":true,"onceDelay":"5","x":130,"y":220,"wires":[["65b68306.0b66ec"]]},{"id":"cd1a4c0c.0147c","type":"json","z":"4c052757.6ab828","name":"JSON Parse","property":"payload","action":"","pretty":false,"x":610,"y":220,"wires":[["744d138a.1f395c"]]},{"id":"744d138a.1f395c","type":"change","z":"4c052757.6ab828","name":"BTC EUR Kurs","rules":[{"t":"set","p":"payload","pt":"msg","to":"msg.payload.bpi.EUR.rate_float","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":280,"y":340,"wires":[["911ee1f9.ccf3a"]]},{"id":"911ee1f9.ccf3a","type":"ccu-sysvar","z":"4c052757.6ab828","name":"Bitcoin","ccuConfig":"38263145.35ea0e","topic":"ReGaHSS/${Name}","change":true,"cache":true,"x":460,"y":340,"wires":[[]]},{"id":"c73c65fe.9c17c8","type":"comment","z":"4c052757.6ab828","name":"Bitcoin Euro Wechselkurs abfragen und in Systemvariable schreiben","info":"","x":340,"y":120,"wires":[]},{"id":"38263145.35ea0e","type":"ccu-connection","z":"","name":"localhost","host":"localhost","regaEnabled":true,"bcrfEnabled":true,"iprfEnabled":true,"virtEnabled":true,"bcwiEnabled":false,"cuxdEnabled":false,"regaPoll":true,"regaInterval":"30","rpcPingTimeout":"60","rpcInitAddress":"127.0.0.1","rpcServerHost":"127.0.0.1","rpcBinPort":"2047","rpcXmlPort":"2048"}]\n')])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])])])},[],!1,null,null,null);r.options.__file="Flow-HTTP-Client.md";s.default=r.exports}}]);